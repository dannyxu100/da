/*
	author: danny.xu
	date:	2011/11/19
	discription: daOption自定义选项控件
*/
(function(j,k){var l=j.document;var m=(function(){var h=function(a){if(da.isFunction(a)||"string"===typeof a)return h.getOption(a);return new h.fnStruct.init(a)};h.fnStruct=h.prototype={oId:0,oObj:null,oParentObj:null,oInput:null,oIcon:null,oText:null,setting:{parent:"",id:"",type:"radio",name:"",checked:false,value:"",text:"",color:"#fff",bg:"#09c",unRadio:false,css:{daOption:"daOption",daOptionHover:"daOption2",daOptionChecked:"daOption3",checkbox:"checkbox",radio:"radio",text:"text"}},value:"",text:"",version:"daOption v1.0 danny.xu 2011/11/19",init:function(a){a=this.setting=da.extend({},this.setting,a);this.oParentObj=da(a.parent);this.oParentObj=0<this.oParentObj.dom.length?this.oParentObj.dom[0]:l.body;if(a.id)this.oId=a.id;else while(null!==l.getElementById("daOption_"+this.oId))this.oId++;a.type="radio"===a.type?"radio":"checkbox";a.checked=!!a.checked;this.value=this.setting.value;this.text=this.setting.text;this.create();this.bindEvent();this.check(a.checked);h.pushCache(this)},create:function(){var a=this.setting,oId=this.oId,oObj,oInput,oIcon,oText;oObj=l.createElement("span");oObj.id="daOption_"+oId;oObj.className=a.css.daOption;oObj.style.display="inline-block";this.oObj=oObj;this.oParentObj.insertBefore(oObj);if(a.text){oText=l.createElement("span");oText.className=a.css.text;oText.innerHTML=a.text;this.oText=oText;this.oObj.insertBefore(oText)}if(da.browser.ie)oInput=l.createElement('<input type="'+a.type+'" name="'+(a.name||oId)+'" />');else{oInput=l.createElement('input');oInput.type=a.type;oInput.name=a.name||oId}oInput.id=oId;oInput.value=a.value;this.oInput=oInput;this.oObj.insertBefore(oInput);oInput.style.display="none";oIcon=l.createElement("span");oIcon.className=a.css[a.type];oIcon.style.display="inline-block";this.oIcon=oIcon;this.oObj.insertBefore(oIcon);this.reSize()},reSize:function(){da(this.oObj).width(da(this.oText).width()+da(this.oIcon).width()+3)},bindEvent:function(){var a=this.setting,context=this;da(this.oObj).bind("mouseover",function(){if(a.css.daOption===this.className){this.className=a.css.daOptionHover;this.style.backgroundColor=a.bg;context.oText.style.color=a.color}}).bind("mouseout",function(){if(a.css.daOptionHover===this.className){this.className=a.css.daOption;this.style.backgroundColor="";context.oText.style.color=""}}).bind("click",function(){if(!context.oInput.checked){context.check(true)}else{context.check(false)}})},show:function(a){if("undefined"!==typeof daFx)da(this.oObj).fadeIn(300,a);else this.oObj.style.display="block"},hide:function(a){if("undefined"!==typeof daFx)da(this.oObj).fadeOut(300,a);else this.oObj.style.display="none"},remove:function(){h.popCache(this);if(this.oObj){var a=this;this.hide(function(){a.oParentObj.removeChild(a.oObj);a.oObj=null})}},text:function(){},color:function(a,b){if(k!==a)this.setting.bg=a;if(k!==b)this.setting.color=b;if(obj.oInput.checked){this.oObj.style.backgroundColor=a;this.oText.style.color=b}},check:function(d){d=!!d;var e=this.setting,context=this;var f=function(a,b,c){if("undefined"===typeof daGif)return;a.oInput.checked=c;if(c){a.oObj.className=e.css.daOptionChecked;a.oObj.style.backgroundColor=e.bg;a.oText.style.color=e.color}else{a.oObj.className=e.css.daOption;a.oObj.style.backgroundColor="";a.oText.style.color=""}daGif({target:a.oIcon,all:6,speed:25,top:"radio"===b?"-16px":"0px",width:16,height:16,isBack:!c})};if("radio"===e.type){var g=e.name;if(d&&!context.oInput.checked){h.getOption(function(a){if("radio"===this.setting.type&&g===this.setting.name&&this.oInput.checked&&a!==context.oId){f(this,"radio",false)}});f(context,"radio",true)}else if(e.unRadio&&!d&&context.oInput.checked)f(context,"radio",false)}else{if(d&&!context.oInput.checked)f(context,"checkbox",true);else if(!d&&context.oInput.checked)f(context,"checkbox",false)}}};h.fnStruct.init.prototype=h.prototype;h.toOption=function(a){var b={parent:a.parentNode,id:a.id,value:a.value,text:a.getAttribute("text")||"",type:a.type,checked:a.checked,name:a.name};daOptionObj=h(b);a.parentNode.replaceChild(daOptionObj.oObj,a)};h.daOptionCache=[];h.pushCache=function(a){var b=h.daOptionCache;b.push({id:a.oId,obj:a})};h.popCache=function(a){var b=h.daOptionCache;for(var i=0,len=b.length;i<len;i++){if(a.oId==b[i].id){b.splice(i,1);return b[i]}}};h.getOption=function(c){var d=h.daOptionCache;if("string"===typeof c){c=c.replace("#","");for(var i=0,len=d.length;i<len;i++){if(c==d[i].id)return d[i].obj}}else if(da.isFunction(c)){da.each(d,function(a,b){return c.call(this.obj,this.id)});return d}return null};h.byName=function(c,d,e){if(!c)return;var f=da.isFunction(d),isAll="boolean"===typeof d,arrObj=[],arrChecked=[],reList;h.getOption(function(a){if(c===this.setting.name){arrObj.push(this);if(this.oInput.checked)arrChecked.push(this)}});if("undefined"===typeof d||f){if(0==arrChecked.length)reList=null;else if(1==arrChecked.length&&"radio"===arrChecked[0].setting.type){reList=arrChecked[0];if(f)d.call(reList,reList.value,reList.text,0)}else{reList=[];da.each(arrChecked,function(a,b){reList.push(this);if(f)d.call(this,this.value,this.text,a)})}return reList}else{if(0>=arrObj.length)return null;if("undefined"===typeof e)e=true;e=!!e;if(isAll)e=d;if("string"===typeof d)d=[d];if(da.isArray(d)||isAll){var g,v1,v2,type;type=arrObj[0].setting.type;reList=isAll?arrObj:[];if("redio"===type&&isAll)return reList;for(var i=0,len=arrObj.length;i<len;i++){g=arrObj[i];if("checkbox"===type){if(isAll){if(e&&g.oInput.checked||!e&&!g.oInput.checked)continue;else e?g.check(true):g.check(false)}else{if(!e&&!g.oInput.checked)continue;if(e&&g.oInput.checked)g.check(false)}}v1=g.oInput.value;for(var n=0,len2=d.length;n<len2;n++){v2=d[n];if(v1==v2){e?g.check(true):g.check(false);reList.push(g)}}}return reList}return}};h.inverse=function(c){var d=[];h.byName(c,function(a,b){d.push(a)});h.byName(c,true);h.byName(c,d,false)};return h})();j.daOption=m})(window);